extends ../layout

block content
  .myth-wrapper
    // Loader Section (VISIBLE FIRST)
    .myth-loader#myth-loader
      .myth-header
        span.breadcrumb > Myth Journey
        h4.status
          if thinkingText
            != thinkingText
          else
            | Pretending to think very hard ðŸ¤–...

      .myth-card
        if thinkingImage
          img(
            src=thinkingImage
            alt="Thinking illustration"
          )
        else
          img(
            src="/images/loding-banner-image.png"
            alt="Thinking illustration"
          )

    // Main content section (HIDDEN INITIALLY)
    main.container#myth-main.hidden
      p.project-name > Myth Journey
      h2.headline1
        | I was not expecting visitors.
        br
        | Anyway.
        br
        | Work or lore?


      .btn-row
        a.btn.primary(href="/work")
          span ðŸ“‚
          | Show me your Work
        a.btn.secondary(href="/about-us")
          span ðŸ‘€
          | Who even are you?
        a.banner-link#random-banner(href="#")
          img.banner(
            src="/images/adults-image.png"
            alt="ADULTS ONLY I LOVE STORIES"
          )

      p.note
        | Is this not what you want? Okay diva, skip the buttons and drop your custom request.
      .chat-area#chat-area

      .chat-buttons
        each q in questions
          button.chat-btn(
            data-text=q.textResponse
            data-meme=q.memeResponse
            data-cta=q.ctaTo
          ) #{q.question}


      .chat-input
        input(type="text" placeholder="Type anythingâ€¦")
        .chat
         img(src="/images/chat-arrow.png", alt="")

  script(src="/js/mythJourney.js")
  //- In your Pug file, at the bottom
  script(src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.0/gsap.min.js")
  script.
    document.addEventListener("DOMContentLoaded", () => {
      const loader = document.getElementById("myth-loader");
      const mainContent = document.getElementById("myth-main");

      const loaderElements = loader.querySelectorAll(".breadcrumb, .status, .myth-card img");
      const mainElements = mainContent.querySelectorAll("h2, p, .btn-row, img");
      const randomPages = [
        "/about-us",
        "/myth-creation",
        "/work",
        "/open-studio",
        "/terms-and-conditions"
      ];

      // Hide main content initially
      gsap.set(mainContent, { opacity: 0, y: 60 });

      // Loader fade-up animation
      gsap.from(loaderElements, {
        y: 60,
        opacity: 0,
        stagger: 0.2,
        duration: 0.8,
        ease: "power2.out",
        onComplete: showMainContent
      });

      const bannerLink = document.getElementById("random-banner");

        if (bannerLink) {
          const randomIndex = Math.floor(Math.random() * randomPages.length);
          bannerLink.href = randomPages[randomIndex];
        }

      // Optional: smooth typing effect for loader status text
      const statusText = loader.querySelector(".status");
      if (statusText) {
        const text = statusText.innerText;
        statusText.innerText = "";
        let i = 0;
        const typingInterval = setInterval(() => {
          statusText.innerText += text[i];
          i++;
          if (i >= text.length) clearInterval(typingInterval);
        }, 50);
      }

      // Function to fade loader out and fade main content in
      function showMainContent() {
        gsap.to(loader, { opacity: 0, duration: 0.5, onComplete: () => loader.style.display = "none" });

        // Fade up main content elements smoothly
        gsap.to(mainContent, { opacity: 1, duration: 0.5 });
        gsap.from(mainElements, {
          y: 60,
          opacity: 0,
          stagger: 0.15,
          duration: 0.8,
          ease: "power2.out"
        });
      }
    });



